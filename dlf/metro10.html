<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Welcome metro</title>

    <!-- Bootstrap core CSS -->
    <link href="../css/bootstrap.min.css" rel="stylesheet">


    <!-- Custom styles for this template -->
    <link href="../css/jumbotron-narrow.css" rel="stylesheet">
	<script src="../js/jquery-2.1.4.min.js"></script>
	<script src="//www.parsecdn.com/js/parse-1.6.7.min.js"></script>
	<script>
	function refresh(){
		Parse.$ = jQuery;
			Parse.initialize("ORdRb6ZtoTRSIUBeDKCcpigKQR9Pr6YJjeguuN9t", "ec8NHsZDP17pTdRjBKQFAPxB8ihduGt6e8NAGdaH");
			var Slot =  Parse.Object.extend("KPMG");
			var query = new Parse.Query(Slot);
			query.equalTo("objectId","CxD6JdgfB6");
			query.first({
					success: function(slot) {
						document.getElementById("slot_metro").value = slot.get("parking_counter");
						document.getElementById("status_metro").innerHTML = slot.get("parking_counter")
					}
			});

      var Slot2 =  Parse.Object.extend("flour");
      var query = new Parse.Query(Slot2);
      query.equalTo("objectId","fAKMXLY847");
      query.first({
          success: function(slot2) {
            document.getElementById("flour_slot_metro").value = slot2.get("parking_counter");
            if(slot2.get("parking_counter")<21){
                                                    document.getElementById("flour_status_metro").innerHTML = "Current Slot: "+slot2.get("parking_counter");
                                                    document.getElementById("flour_metro_min").disabled= "";
                                                    document.getElementById("flour_slot_metro").disabled= "";
                                                    document.getElementById("flour_metro_add").disabled= "";
                                                    document.getElementById("flour_metro_less").disabled= "disabled";
                                                    document.getElementById("flour_metro_enter").disabled="";
          }
          else {
            document.getElementById("flour_status_metro").innerHTML = "Available";
          }
          }
      });
		}
		window.onload = function(){refresh();};
	</script>
  </head>

  <body>

    <div class="container">
      <div class="header clearfix">
        <nav>
          <ul class ="nav nav-pills pull-right">
			<li role="presentation" class="active"><a href="../index.html">Logout</a></li>
		  </ul>
        </nav>
      </div>

	  <div class="jumbotron">
		<h2 style="color:#984807"><strong>KPMG Metro Counter</strong></h2>
		<hr>
		<button type="button"  onclick="metro_minus()" class="btn-sm btn-danger">-</button>
		<input id ="slot_metro" value="" type="number" ></input>
		<button type="button"  onclick="metro_plus()"  class="btn-sm btn-success">+</button>
		<br>
		<button type="button"  onclick="metro_enter()" class="btn-lg btn-success">Enter</button>
		<br>
		<h2 id ="status_metro" style="color:#984807"><strong></strong></h2>
	</div>

	<script>
			function metro_enter() {
			Parse.$ = jQuery;
			Parse.initialize("ORdRb6ZtoTRSIUBeDKCcpigKQR9Pr6YJjeguuN9t", "ec8NHsZDP17pTdRjBKQFAPxB8ihduGt6e8NAGdaH");
			var Slot =  Parse.Object.extend("KPMG");
			var query = new Parse.Query(Slot);
			query.equalTo("objectId","CxD6JdgfB6");
			query.first({
				success: function(slot) {
				{
						if(document.getElementById("slot_metro").value <40 && document.getElementById("slot_metro").value >= 0)
						{
						slot.set("parking_counter",parseInt(document.getElementById("slot_metro").value));
						metro_insight(slot.get("parking_counter"));
						slot.save();
						document.getElementById("status_metro").innerHTML = slot.get("parking_counter")
					}
					}
				}
			});
		}


		function metro_plus() {
			Parse.$ = jQuery;
			Parse.initialize("ORdRb6ZtoTRSIUBeDKCcpigKQR9Pr6YJjeguuN9t", "ec8NHsZDP17pTdRjBKQFAPxB8ihduGt6e8NAGdaH");
			var Slot =  Parse.Object.extend("KPMG");
			var query = new Parse.Query(Slot);
			query.equalTo("objectId","CxD6JdgfB6");
			query.first({
			success: function(slot) {
			metro_insight(slot.get("parking_counter"));
				if(slot.get("parking_counter") < 39)
				{
					slot.increment("parking_counter", 1);
					slot.save();
					document.getElementById("slot_metro").value = slot.get("parking_counter");
					document.getElementById("status_metro").innerHTML = slot.get("parking_counter");
					}
				}
			});
		}

		function metro_minus() {
			Parse.$ = jQuery;
			Parse.initialize("ORdRb6ZtoTRSIUBeDKCcpigKQR9Pr6YJjeguuN9t", "ec8NHsZDP17pTdRjBKQFAPxB8ihduGt6e8NAGdaH");
			var Slot =  Parse.Object.extend("KPMG");
			var query = new Parse.Query(Slot);
			query.equalTo("objectId","CxD6JdgfB6");
			query.first({
			success: function(slot) {
				metro_insight(slot.get("parking_counter"));
				if(slot.get("parking_counter") > 0)
				{
					slot.increment("parking_counter", -1);
					slot.save();
					document.getElementById("slot_metro").value = slot.get("parking_counter");
					document.getElementById("status_metro").innerHTML = slot.get("parking_counter");
					}
				}
			});
		}


		function metro_insight(a) {
                        var a = a;
                        Parse.$ = jQuery;
                        Parse.initialize("ORdRb6ZtoTRSIUBeDKCcpigKQR9Pr6YJjeguuN9t", "ec8NHsZDP17pTdRjBKQFAPxB8ihduGt6e8NAGdaH");
                        var ins = Parse.Object.extend("kpmg_insights");
                        var ins = new ins();
                        ins.save({parkin_name: "Metro",parkin_count: a}).then(function(object) {
                    });
		}

		</script>

    <!--- Flour metro PARKING-->

    <div class="jumbotron">
      <h2 style="color:#984807"><strong>Flour metro Parking</strong></h2>
      <hr>
      <button type="button"  id= "flour_metro_less" onclick="flour_update_metro()" class="btn-md btn-warning" >30 Slots Left</button>
      <button type="button"  id= "flour_metro_avail" onclick="flour_metro_available()" class="btn-md btn-success" >Available</button>
      <hr>
      <button type="button"  id="flour_metro_min" onclick="flour_metro_minus()" class="btn-sm btn-danger" disabled>-</button>
      <input id ="flour_slot_metro" value="" type="number" disabled ></input>
      <button type="button"  id="flour_metro_add" onclick="flour_metro_plus()" class="btn-sm btn-success" disabled>+</button>
      <br>
      <button type="button"  id="flour_metro_enter" onclick="flour_metro_enter()" class="btn-sm btn-primary" disabled>Enter</button>
      <hr>
      <h2 id ="flour_status_metro" style="color:#984807"><strong></strong></h2>
      <hr>
    </div>


    <script>
                  function flour_metro_available() {
                          Parse.$ = jQuery;
                          Parse.initialize("ORdRb6ZtoTRSIUBeDKCcpigKQR9Pr6YJjeguuN9t", "ec8NHsZDP17pTdRjBKQFAPxB8ihduGt6e8NAGdaH");
                          var Slot =  Parse.Object.extend("flour");
                          var query = new Parse.Query(Slot);
                          query.equalTo("objectId","fAKMXLY847");
                          query.first({
                                success: function(slot) {
                                       slot.set("parking_counter",31);
                                       slot.save();
                                      document.getElementById("flour_status_metro").innerHTML ="Available";
                                      document.getElementById("flour_metro_min").disabled= "disabled";
                                      document.getElementById("flour_metro_add").disabled= "disabled";
                                      document.getElementById("flour_metro_less").disabled= "";
                                      document.getElementById("flour_metro_enter").disabled="disabled";
                                      document.getElementById("flour_slot_metro").disabled="disabled";
                                      slot.save();
                                    }
                          })
                  }


                    function flour_metro_enter() {
                          Parse.$ = jQuery;
                          Parse.initialize("ORdRb6ZtoTRSIUBeDKCcpigKQR9Pr6YJjeguuN9t", "ec8NHsZDP17pTdRjBKQFAPxB8ihduGt6e8NAGdaH");
                          var Slot =  Parse.Object.extend("flour");
                          var query = new Parse.Query(Slot);
                          query.equalTo("objectId","fAKMXLY847");
                          query.first({
                            success: function(slot) {
                            if(document.getElementById("flour_slot_metro").value < 31 && document.getElementById("flour_slot_metro").value >=0)
                                                        {
                              slot.set("parking_counter",parseInt(document.getElementById("flour_slot_metro").value));
                              slot.save();
                              document.getElementById("flour_slot_metro").value=slot.get("parking_counter");
                              document.getElementById("flour_status_metro").innerHTML = slot.get("parking_counter");
                            }
                            }
                          })
                    }

                  function flour_update_metro() {
                    Parse.$ = jQuery;
                    Parse.initialize("ORdRb6ZtoTRSIUBeDKCcpigKQR9Pr6YJjeguuN9t", "ec8NHsZDP17pTdRjBKQFAPxB8ihduGt6e8NAGdaH");
                    var Slot =  Parse.Object.extend("flour");
                    var query = new Parse.Query(Slot);
                    query.equalTo("objectId","fAKMXLY847");
                    query.first({
                      success: function(slot) {
                        slot.set("parking_counter",30);
                        document.getElementById("flour_slot_metro").value=slot.get("parking_counter");
                        document.getElementById("flour_status_metro").innerHTML ="Current status" + ": " + slot.get("parking_counter");
                        document.getElementById("flour_metro_min").disabled= "";
                        document.getElementById("flour_slot_metro").disabled= "";
                        document.getElementById("flour_metro_add").disabled= "";
                        document.getElementById("flour_metro_less").disabled= "disabled";
                        document.getElementById("flour_metro_enter").disabled="";
                        slot.save();
                      }
                    })
                  }

                  function flour_metro_minus(){
                    Parse.$ = jQuery;
                    Parse.initialize("ORdRb6ZtoTRSIUBeDKCcpigKQR9Pr6YJjeguuN9t", "ec8NHsZDP17pTdRjBKQFAPxB8ihduGt6e8NAGdaH");
                    var Slot =  Parse.Object.extend("flour");
                    var query = new Parse.Query(Slot);
                    query.equalTo("objectId","fAKMXLY847");
                    query.first({
                      success: function(slot) {
                        if(slot.get("parking_counter") > 0)
                      {
                        slot.increment("parking_counter", -1);
                        slot.save();
                        document.getElementById("flour_slot_metro").value = slot.get("parking_counter");
                        document.getElementById("flour_status_metro").innerHTML = "Current Slot: "+slot.get("parking_counter");
                        }
                      }
                    })
                  }

                  function flour_metro_plus() {
                    Parse.$ = jQuery;
                    Parse.initialize("ORdRb6ZtoTRSIUBeDKCcpigKQR9Pr6YJjeguuN9t", "ec8NHsZDP17pTdRjBKQFAPxB8ihduGt6e8NAGdaH");
                    var Slot =  Parse.Object.extend("flour");
                    var query = new Parse.Query(Slot);
                    query.equalTo("objectId","fAKMXLY847");
                    query.first({
                      success: function(slot) {
                        if(slot.get("parking_counter") <  30)
                            {
                        slot.increment("parking_counter", 1);
                        slot.save();
                        document.getElementById("flour_slot_metro").value = slot.get("parking_counter");
                        document.getElementById("flour_status_metro").innerHTML = "Current Slot: "+ slot.get("parking_counter");
                        }

                      else {
                        slot.set("parking_counter",31);
                        document.getElementById("flour_metro_min").disabled= "disabled";
                        document.getElementById("flour_metro_add").disabled= "disabled";
                        document.getElementById("flour_metro_less").disabled= "";
                        document.getElementById("flour_metro_enter").disabled="disabled";
                        document.getElementById("flour_slot_metro").disabled="disabled";
                        document.getElementById("flour_status_metro").innerHTML ="Available";
                        slot.save();
                        }
                      }
                    })
                  }

      </script>

      </div>
    </div>
  </body>
</html>
